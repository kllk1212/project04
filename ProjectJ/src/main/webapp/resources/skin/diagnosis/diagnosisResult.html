<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <!-- 10월 4일 한글깨져서 헤더 주석
    <meta http-equiv="X-UA-Compatible" content="ie=edge, chrome=1">
      -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">

    <title>창업나무</title>

    <!-- <link rel="icon" href="/{=favicon}" -->

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
    <link rel="stylesheet" href="../css/main.css?v=<?=time()?>">

    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/plugins/animation.gsap.js"></script>
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <script src="../js/jquery.cookie.js"></script>
    <script defer src="../js/common.js"></script>

    <!-- <script src="https://www.youtube.com/player_api"></script> -->


</head>
<!-- ============================================================================= -->
<!-- ============================================================================= -->

<!-- 마우스드래그금지 -->
<!-- <body ondragstart="return false" onselectstart="return false"> -->

<body>
    <h1 id="Homepage" class="bld">창업나무 홈페이지</h1>
    <!-- wrap -->
    <div id="wrap">
        <!-- container -->
        <div id="container">
            <!-- ======================================== -->
            <!-- header -->
            <header id="header" class="header">
                <div class="header_wrap layout_wrap">
                    <div class="header_left">
                        <div class="header_logo">
                            <a href="../main/main">
                                <img src="../img/common/logo.png" alt="창업나무" class="vP">
                                <img src="..//img/common/logoH_tree.png" alt="창업나무" class="vT">
                            </a>
                        </div>
                        <nav class="nav">
                            <ul id="gnb" class="gnb">
                                <li><a href="../main/main">홈</a></li>
                                <li class="depth">
                                    <a href="">프렌차이즈 정보</a>
                                    <div>
                                        <ul class="fx">
                                            <li><a href="../franchise/reviewMain">기업평점/리뷰</a></li>
                                            <li><a href="../franchise/rankMain">순위</a></li>
                                            <li><a href="../map/mapSearchMain">지도</a></li>
                                            <li><a href="../diagnosis/diagnosisMain">조건검색</a></li>
                                        </ul>
                                    </div>
                                </li>
                                <li><a href="../franchise/incomeCalcMain">순이익 계산기</a></li>
                                <li><a href="../main/siteInfo">사이트 소개</a></li>
                                <li><a href="">QnA</a></li>
                            </ul>
                        </nav>
                    </div>
                    <!-- <%if(session.getAttribute("user_id")==null){%> -->
                    <div class="header_right">
                        <button type="button" id="headerBtn" onclick="location.href='../main/login' ">로그인 <span class="vP">및 회원가입</span></button>
                    </div>
                    <!-- <%}else{%> -->
                    <!-- <div class="header_right">
                        <button type="button" id="headerBtn"><%=session.getAttribute("user_id") %>님</button>
                        <button type="button" id="headerBtn" onclick="location.href='../main/logout'">로그아웃</button>
                    </div> -->
                    <!-- <%} %> -->
                </div>
            </header>

            <div id="contents" class="contents diagnosis diagnosisMain page page-break" data-id="diagnosis">

                <!-- 검색 결과 페이지 -->
                <div class="layout_wrap pt-B">
                    <h2 class="pt-B tc">프랜차이즈 검색결과</h2>
                    <!-- <span class="line"></span> -->
                    <!-- <div>선택한 프렌차이즈는 ${comName} 입니다</div> -->
                    <!-- 브랜드 정보 / 가맹현황 / 기업 정보 : 노출 선택 탭 -->
                    <div class="tab">
                        <!-- ## tab header ##-->
                        <div class="tab_header tc center-m">
                            <!-- <span class="line"></span> -->
                            <div class="inwrap">
                                <div class="tl">
                                    선택한 프렌차이즈는 <br>
                                    <p><i class="fc-red">서울</i>지역 <i class="fc-red">네네치킨</i>&nbsp;입니다</p>
                                </div>
                                <div>
                                    <ul class="tab_btn center-f">
                                        <li class="on">매출 비교 그래프</li>
                                        <li>가맹 현황</li>
                                        <li>브랜드 정보</li>
                                        <!-- <li>기업 정보</li> -->
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <span class="line mt-A mb-A"></span>
                        <!-- ## tab content ##-->
                        <!-- <div> -->
                        <div class="tab_cont pt-A pb-A">

                            <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                            <!-- chart tab (매출 비교 값 그래프) -->
                            <div class="tab_chart center-m">
                                <div class="fx jsb">
                                    <div class="tab_inwrap">
                                        <table>
                                            <tr>
                                                <th>${comName} 매장들의 평균 매출액</th>
                                                <td class="numTrans">${avgSales}</td>
                                            </tr>
                                            <tr>
                                                <th>${ areaName} 지역의 ${cDTO.c_type } 업종 프랜차이즈 평균 매출</th>
                                                <td class="numTrans">${avgSales}</td>
                                            </tr>
                                            <tr>
                                                <th>전국 ${cDTO.c_type } 업종 프랜차이즈 평균 매출</th>
                                                <td class="numTrans">${avgSalesAll}</td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="tab_inwrap">
                                        <p class="unit">(단위: 만원)</p>
                                        <div class="tab_chart_inwrap fx fdc">
                                            <div id="chart" class="chart"></div>
                                            <ul class="category_num">
                                                <li>
                                                    <!-- <span>${cDTO.c_tAvgSales/100}만원</span> -->
                                                    <!-- <c:set var="avg" value="${cDTO.c_tAvgSales/100}" /> -->
                                                    <!--노출되지않음 소수점버림  -->
                                                    <!-- <span style="font-size: 10pt">${comName }</span></br>
                                                    <span><fmt:formatNumber type="number"  pattern="0" value="${ ((avg*100) - ((avg*100)%1)) * (1/100)   } " /></span> -->
                                                    <p>핸즈커피(HANDSCOFFEE)</p>
                                                    <span class="numTrans">7248</span>
                                                </li>
                                                <li>
                                                    <!-- <span>${avgSales}만원</span> -->
                                                    <!-- <span style="font-size: 15pt">${areaName }평균</span></br>
                                                    <span>${avgSales}</span> -->
                                                    <p>서울평균</p>
                                                    <span class="numTrans">2243</span>
                                                </li>
                                                <li>
                                                    <!-- <span>${avgSalesAll}만원</span> -->
                                                    <!-- <span style="font-size: 15pt">전국평균</span></br>
                                                    <span>${avgSalesAll}</span> -->
                                                    <p>전국평균</p>
                                                    <span class="numTrans">2057</span>
                                                </li>
                                            </ul>
                                            <span class="line"></span>
                                        </div>
                                        <div class="category_list">
                                            <div>
                                                <p>${comName} 매장들의 평균 매출액</p>
                                            </div>
                                            <div>
                                                <p>${ areaName} 지역의 ${cDTO.c_type } 업종 프랜차이즈 평균 매출
                                                <p>
                                            </div>
                                            <div>
                                                <p>전국 ${cDTO.c_type } 업종 프랜차이즈 평균 매출</p>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>
                            <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                            <!-- franchise info tab (가맹 현황) -->
                            <div class="tab_fc">
                                <div class="fx jsb">
                                    <div class="tab_inwrap">
                                        <table>
                                            <tr>
                                                <th>가맹 총부담금</th>
                                                <td class="numTrans">${cDTO.c_totalFee*1000}원</td>
                                            </tr>
                                            <tr>
                                                <th>평균 매출액</th>
                                                <td class="numTrans">${cDTO.c_tAvgSales*100}원</td>
                                            </tr>
                                            <tr>
                                                <th>1평당 평균매출액</th>
                                                <td class="numTrans">${cDTO.c_tSquareSales*100}원</td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="tab_inwrap commentBox">

                                        <!-- ${areaName}지역의 ${cDTO.c_type } 업종 프랜차이즈 매장수 는  ${allFchaEA }개 입니다
                                         ${ areaName}지역의 ${comName}점포수는 ${fDTO[0].f_franchiseeEa} 개 입니다. (${fDTO[0].f_year} 기준)  -->

                                        <!-- ${ areaName}지역의 ${comName}점포수는 ${fDTO[0].f_franchiseeEa} 개 입니다.  -->
                                        <!-- ${ areaName}지역에는 전국 ${fDTO[0].f_franchiseeEa / cDTO.c_storeCount }%의 ${comName}이 (가)있습니다.  -->
                                        <!-- 이 데이터는 (${fDTO[0].f_year} 년 기준입니다.  -->

                                        <!-- 3번째줄 -->
                                        <!-- 산텍지역 선택 브랜드 매장수 / 선택지역 해당업종 브랜드 매장수 -->
                                        <!-- 168/1830 -->
                                        <!-- <span class="center">${fDTO[0].f_franchiseeEa} /${allFchaEA }</span> -->

                                        <!-- 4번째줄 -->
                                        <!-- 브랜드정보에있는 네네치킨 점포수 최근 기준 개수 /총 점포수 -->
                                        <!-- 168/1096 -->
                                        <!-- <span class="center">${fDTO[0].f_franchiseeEa / cDTO.c_storeCount }</span> -->

                                        <div class="inwrap">
                                            <!-- 노출되지않음 소수점 변환위해-->
                                            <!-- ${cDTO.c_storeCount }전국네네치킨매장수 // fDTO[0].f_franchiseeEa 지역의 네네치킨 매장수
                                                    allFchaEA // 동종업계 해당지역의 총 매장수
                                               -->
                                            <c:set var="num" value="${fDTO[0].f_franchiseeEa/cDTO.c_storeCount*100 }" />
                                            <!--서울네네치킨 / 전국네네치킨 % -->
                                            <c:set var="num2" value="${fDTO[0].f_franchiseeEa / allFchaEA*100}" /><!-- 지역네네치킨 / 지역치킨업종 -->


                                            <p>${areaName} 지역의 ${cDTO.c_type } 업종 프랜차이즈 매장수 는 <span class="fc-red">${allFchaEA }개</span> 입니다.</p>
                                            <p>전국의 ${comName} 매장수 는 <span class="fc-red">총 ${cDTO.c_storeCount }개</span> 입니다.</p>
                                            <p>${areaName} 지역의 ${cDTO.c_comName } 점포수는 <span class="fc-red">${fDTO[0].f_franchiseeEa }개</span> 입니다.</p>
                                            <p>${cDTO.c_comName }은(는) ${areaName} 지역 ${cDTO.c_type } 업종 프렌차이즈 중 <span class="fc-red">
                                                    <fmt:formatNumber type="number" pattern="0.00" value="${ ((num2*100) - ((num2*100)%1)) * (1/100)   } " />%
                                                </span>를 차지합니다.</p>
                                            <p>${areaName} 지역에는 전국 ${cDTO.c_comName } 매장 중 <span class="fc-red">
                                                    <fmt:formatNumber type="number" pattern="0.00" value="${ ((num*100) - ((num*100)%1)) * (1/100)   } " />%
                                                </span>가 있습니다.</p>
                                            <p>이 데이터는 <span class="fc-red">2020년 기준</span>입니다.</p>
                                        </div>
                                        <div class="inwrap fx jc">
                                            <div class="doughnutBox fx fdc">
                                                <div class="doughnut doughnut1">
                                                    <span class="center">
                                                        <fmt:formatNumber type="number" pattern="0.00" value="${ ((num2*100) - ((num2*100)%1)) * (1/100)   } " />%
                                                    </span>
                                                </div>
                                                <small class="tc">그래프 1</small>
                                            </div>
                                            <div class="doughnutBox fx fdc">
                                                <div class="doughnut doughnut2">
                                                    <span class="center">
                                                        <fmt:formatNumber type="number" pattern="0.00" value="${ ((num*100) - ((num*100)%1)) * (1/100)   } " />%
                                                    </span>
                                                </div>
                                                <small class="tc">그래프 2</small>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                            <!-- brand/company info tab(브랜드 및 회사 정보)-->
                            <div class="tab_brand">
                                <div class="fx jsb">
                                    <div class="tab_inwrap">
                                        <h3>브랜드 정보</h3>
                                        <table>
                                            <!-- <tr>
                                                <th>영업표지명<br>(브랜드명)</th>
                                                <td>${cDTO.c_comName } </td>
                                            </tr>
                                            <tr>
                                                <th>회사분류</th>
                                                <td>${cDTO.c_type } </td>
                                            </tr>
                                            <tr>
                                                <th>총 점포수</th>
                                                <td>${cDTO.c_storeCount } </td>
                                            </tr> -->
                                            <tr>
                                                <th>영업표지명<br>(브랜드명)</th>
                                                <td>
                                                    <a style="text-decoration : underline;" href='https://search.naver.com/search.naver?where=nexearch&sm=top_hty&fbm=1&ie=utf8&query=${cDTO.c_comName }' target='_blank'><span
                                                            class="fc-red">${cDTO.c_comName }</span></a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <!-- 업종분류?? -->
                                                <th>회사분류</th>
                                                <td>${cDTO.c_type }</td>
                                            </tr>
                                            <tr>
                                                <th>총 점포수</th>
                                                <td>${cDTO.c_storeCount }</td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="tab_inwrap">
                                        <h3>기업 정보</h3>
                                        <table>
                                            <tr>
                                                <th>상호명</th>
                                                <td>
                                                    <a style="text-decoration : underline;" href='https://search.naver.com/search.naver?where=nexearch&sm=top_hty&fbm=1&ie=utf8&query=${cDTO.c_comTitle }' target='_blank'><span
                                                            class="fc-red">${cDTO.c_comTitle }</span></a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>회사대표</th>
                                                <td>${cDTO.c_comBoss }</td>
                                            </tr>
                                            <tr>
                                                <th>사업자유형</th>
                                                <td>${cDTO.c_comBm }</td>
                                            </tr>
                                            <tr>
                                                <th>회사주소</th>
                                                <td>${cDTO.c_comAddr }</td>
                                            </tr>
                                            <tr>
                                                <th>대표번호</th>
                                                <td>${cDTO.c_comNum } </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <!-- company info tab (기업 정보) -->
                            <!-- <div class="tab_com">
                            </div> -->
                        </div>
                        <!-- </div> -->
                        <span class="line mt-A mb-A"></span>
                        <!-- ## tab footer ##-->
                        <div class="tab_footer center-f">
                            <div class="inwrap btn_area">
                                <!-- <button type="button" onclick="location.href='/diagnosis/diagnosisMain';"> 다시 검색하기</button> -->
                                <!-- <button type="button" onclick="location.href='/franchise/incomeCalcMain?comName=${comName}';"> ${comName}(으)로 예상순이익 계산해보기</button> -->
                                <button type="button" onclick="location.href='/diagnosis/diagnosisMain';"> 다른 브랜드 검색하기</button>
                                <button type="button" onclick="location.href='/franchise/incomeCalcMain?comName=${comName}';"> ${comName}(으)로 예상순이익 계산해보기</button>
                            </div>
                        </div>

                    </div>

                </div>
            </div>


            <script>
                $(function() {
                    /// =======================================  ///
                    // 매출 비교 그래프 차트 그리기
                    /// =======================================  ///
                    let fchaAvg = "${cDTO.c_tAvgSales/100}"; // 프랜차이즈 평균
                    let areaAvg = "${avgSales}"; // 선택 프차,지역 평균
                    let allAvg = "${avgSalesAll}"; // 전국 업종 평균
                    var values = [fchaAvg, areaAvg, allAvg];
                    // var values1 = [300, 500];
                    // var values2 = [300, 200];
                    // var values = [${cDTO.c_tAvgSales/100},${avgSales},${avgSalesAll}];
                    drawChart(values, "#chart", 10)

                    // drawChart(values1,"#chart_1",10)
                    // drawChart(values2,"#chart_2",10)

                    function drawChart(data, selector, padding) {
                        var max = Math.max.apply(Math, data);
                        var chart = document.querySelector(selector);
                        // var barwidth = ((chart.offsetWidth-(values.length-1)*padding-(data.length)*10)/data.length);
                        var barwidth = ((chart.offsetWidth - 1 * padding - (data.length) * 10) / data.length);
                        var sum = data.reduce(function(pv, cv) {
                            return pv + cv;
                        }, 0);
                        var left = 0;
                        for (var i in data) {
                            var newbar = document.createElement('div');
                            newbar.setAttribute("class", "bar");
                            newbar.style.width = barwidth + "px";
                            newbar.style.height = ((data[i] / max) * 100) + "%";
                            newbar.style.left = left + "px";
                            chart.appendChild(newbar);
                            left += (barwidth + padding + 10);
                        }
                    }

                    /// =======================================  ///
                    // 가맹현황 원형차트 그리기
                    /// =======================================  ///
                    const doughnut1 = document.querySelector('.doughnut1');
                    const doughnut2 = document.querySelector('.doughnut2');
                    const a = "${fDTO[0].f_franchiseeEa/cDTO.c_storeCount*100}";
                    const b = "${fDTO[0].f_franchiseeEa / allFchaEA*100}";

                    const makeChart = (percent, classname, color) => {
                        let i = 1;
                        let doughnutFn = setInterval(function() {
                            if (i < percent) {
                                colorFn(i, classname, color);
                                i++;
                            } else {
                                clearInterval(doughnutFn);
                            }
                        }, 10);
                    }

                    const colorFn = (i, classname, color) => {
                        classname.style.background = "conic-gradient(" + color + " 0% " + i + "%, #dedede " + i + "% 100%)";
                    }

                    // 도넛 차트 1번
                    makeChart(b, doughnut1, 'var(--blue)');
                    // 도넛 차트 2번
                    makeChart(a, doughnut2, '#0A174E');

                    const replay = () => {
                        // 도넛 차트 1번
                        makeChart(b, doughnut1, 'var(--blue)');
                        // 도넛 차트 2번
                        makeChart(a, doughnut2, '#0A174E');
                    }

                    /// =======================================  ///
                    // 테이블에 있는 값 콤마 찍기 / 화폐 단위 자동 추가
                    /// =======================================  ///
                    $('.numTrans').each(function(i, e) {
                        num = $(this).text();
                        num = parseInt(num).toLocaleString('ko-KR');
                        // console.log(num);
                        if ($(this).closest('table').length > 0) {
                            $(this).text(num + '만원');
                        } else {
                            $(this).text(num);
                        }
                    });

                    /// =======================================  ///
                    // 차트에 텍스트 ()로 길어지는 곳 split
                    /// =======================================  ///
                    $('.category_num p').each(function(i, e) {
                        var comNm = $(this).text().split('(')[0];
                        // console.log(comNm);
                        $(this).text(comNm);
                    });
                    // $('.tab_fc td').each(function(i,e){
                    //     num = $(this).text();
                    //     num = parseInt(num).toLocaleString('ko-KR');
                    //     // console.log(num);
                    //     $(this).text(num+'원');
                    // });

                    /// =======================================  ///
                    // 탭 클릭 시 컨텐츠 전환
                    /// =======================================  ///
                    $('.tab_btn li').on('click', function() {
                        let idx = $(this).index('.tab_btn li')
                        // console.log($(this).index('.tab_btn li'));
                        $('.tab_btn li').removeClass('on');
                        $(this).addClass('on');
                        $('.tab_cont > div').hide();
                        $('.tab_cont > div').eq(idx).fadeIn();

                        replay();
                    });

                });
            </script>
            <!-- ======================================== -->
            <!-- footer -->
            <footer id="footer" class="footer">
                <div class="footer_wrap layout_wrap Hmax">
                    <div class="footer_left fx">
                        <div class="footer_img">
                            <img src="../img/common/logoH_tree.png" alt="footer logo">
                        </div>
                        <address class="address">
                            <span>대표자 : Double J</span>
                            <span>주소 : 서울특별시 마포구 신촌로 94, 7층(702호)</span>
                        </address>
                    </div>
                    <div class="footer_right">
                        <a href="tel:02-716-1006" class="fx alc">
                            <div class="cs_img">
                                <img src="../img/common/call.png" alt="고객센터">
                            </div>
                            <div class="cs_txt">
                                고객센터<br>
                                02.716.1006
                            </div>
                        </a>
                    </div>
                </div>
            </footer>
            <div class="mini-footer">
                <p>이 데이터는 창업나무에서 출력된 자료입니다.</p>
                <p>실제 창업 조건과 운영 환경에 따라 오차가 발생할 수 있습니다.</p>
            </div>
            <div class="overlay"></div>
            <!-- //footer -->
        </div>
        <!-- //container -->
    </div>
    <!-- //wrap -->
</body>

</html>
